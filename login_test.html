<!doctype html>
<html>
<head>
<meta name="chromevox" content-script="no">
<title>フォーム管理システム</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" nonce="rx9Y2a6kfTH6grR2ECH5Iw"><link rel="stylesheet" href="/static/macros/client/css/858635081-mae_html_css_ltr.css">
<script type="text/javascript" src="/static/macros/client/js/3779779413-warden_bin_i18n_warden__ja.js"></script>
</head>
<body>
<table id="warning-bar-table" class="full_size" cellspacing="0" cellpadding="0"><tr><td><div id="warning" class="warning-bar"></div></td></tr><tr><td style="height: 100%"><iframe id="sandboxFrame" title="フォーム管理システム" allow="accelerometer *; ambient-light-sensor *; autoplay *; camera *; clipboard-read *; clipboard-write *; encrypted-media *; fullscreen *; geolocation *; gyroscope *; magnetometer *; microphone *; midi *; payment *; picture-in-picture *; screen-wake-lock *; speaker *; sync-xhr *; usb *; web-share *; vibrate *; vr *" sandbox="allow-downloads allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation allow-storage-access-by-user-activation">
</iframe>
</td></tr></table><script nonce="O0GWf1J9pAIsow2rYsLHcw">
(function() {
var el = document.getElementById('sandboxFrame');
el.onload = function() {
goog.script.init("\x7b\x22functionNames\x22:\x5b\x22setupSpreadsheet\x22,\x22doGet\x22,\x22getSignupPage\x22,\x22doPost\x22,\x22processLogin\x22,\x22getLoginPage\x22,\x22redirectToLogin\x22,\x22testUserRegistrationAndLogin\x22,\x22testSignupFeature\x22,\x22checkSignupIssues\x22,\x22registerNewUser\x22,\x22loginUser\x22,\x22getUserEmail\x22,\x22generateRandomId\x22,\x22generateRandomPassword\x22\x5d,\x22sandboxMode\x22:\x22IFRAME_SANDBOX\x22,\x22callbackTimeout\x22:390000,\x22deploymentId\x22:\x22AKfycbztjtQWr4xlgESVzPWTVmIhIjdC6FWtmRBZfobWeuu0dU3RnyRzqzO2R1TylWvrxHA7ww\x22,\x22eei\x22:\x22\x22,\x22sandboxHost\x22:\x22https:\/\/n-oesxaovipkrlw2uvlcbs2ggnkojkaxm2i4u55ji-0lu-script.googleusercontent.com\x22,\x22clientSideProperties\x22:\x7b\x22google.script.sandbox.mode\x22:\x22IFRAME_SANDBOX\x22,\x22google.script.host.origin\x22:\x22https:\/\/script.google.com\x22\x7d,\x22actionPrefix\x22:\x22\/macros\/s\/AKfycbztjtQWr4xlgESVzPWTVmIhIjdC6FWtmRBZfobWeuu0dU3RnyRzqzO2R1TylWvrxHA7ww\x22,\x22userHtml\x22:\x22\x3c!DOCTYPE html\x3e\\n\x3chtml lang\x3d\\\x22ja\\\x22\x3e\\n\x3chead\x3e\\n  \x3cmeta charset\x3d\\\x22UTF-8\\\x22\x3e\\n  \x3cmeta name\x3d\\\x22viewport\\\x22 content\x3d\\\x22width\x3ddevice-width, initial-scale\x3d1.0\\\x22\x3e\\n  \x3ctitle\x3eログイン画面\x3c\\\/title\x3e\\n  \x3cstyle\x3e\\n    body \x7b font-family: \x27Segoe UI\x27, sans-serif; background: #f5f5f5; \x7d\\n    .login-container \x7b\\n      max-width: 350px;\\n      margin: 60px auto;\\n      background: #fff;\\n      border-radius: 8px;\\n      box-shadow: 0 2px 8px rgba(0,0,0,0.1);\\n      padding: 32px 24px;\\n    \x7d\\n    h2 \x7b text-align: center; margin-bottom: 24px; \x7d\\n    .form-group \x7b margin-bottom: 18px; \x7d\\n    label \x7b display: block; margin-bottom: 6px; \x7d\\n    input\x5btype\x3d\\\x22text\\\x22\x5d, input\x5btype\x3d\\\x22password\\\x22\x5d \x7b\\n      width: 100%;\\n      padding: 8px 10px;\\n      border: 1px solid #ccc;\\n      border-radius: 4px;\\n      box-sizing: border-box;\\n    \x7d\\n    .actions \x7b display: flex; justify-content: space-between; align-items: center; \x7d\\n    .error \x7b color: #d32f2f; text-align: center; margin-bottom: 12px; \x7d\\n    button \x7b width: 100%; padding: 10px; background: #1976d2; color: #fff; border: none; border-radius: 4px; font-size: 1rem; cursor: pointer; \x7d\\n    button:hover \x7b background: #1565c0; \x7d\\n    .register-link \x7b text-align: center; margin-top: 18px; font-size: 0.95rem; \x7d\\n    .register-link a \x7b color: #1976d2; text-decoration: none; \x7d\\n    .register-link a:hover \x7b text-decoration: underline; \x7d\\n  \x3c\\\/style\x3e\\n\x3c\\\/head\x3e\\n\x3cbody\x3e\\n  \x3cdiv class\x3d\\\x22login-container\\\x22\x3e\\n    \x3ch2\x3eログイン\x3c\\\/h2\x3e\\n    \x3cdiv id\x3d\\\x22error\\\x22 class\x3d\\\x22error\\\x22 style\x3d\\\x22display:none;\\\x22\x3e\x3c\\\/div\x3e\\n    \x3cform id\x3d\\\x22loginForm\\\x22\x3e\\n      \x3cdiv class\x3d\\\x22form-group\\\x22\x3e\\n        \x3clabel for\x3d\\\x22loginId\\\x22\x3eID\x3c\\\/label\x3e\\n        \x3cinput type\x3d\\\x22text\\\x22 id\x3d\\\x22loginId\\\x22 name\x3d\\\x22loginId\\\x22 required autocomplete\x3d\\\x22username\\\x22\x3e\\n      \x3c\\\/div\x3e\\n      \x3cdiv class\x3d\\\x22form-group\\\x22\x3e\\n        \x3clabel for\x3d\\\x22password\\\x22\x3eパスワード\x3c\\\/label\x3e\\n        \x3cinput type\x3d\\\x22password\\\x22 id\x3d\\\x22password\\\x22 name\x3d\\\x22password\\\x22 required autocomplete\x3d\\\x22current-password\\\x22\x3e\\n      \x3c\\\/div\x3e\\n      \x3cdiv class\x3d\\\x22form-group actions\\\x22\x3e\\n        \x3clabel\x3e\x3cinput type\x3d\\\x22checkbox\\\x22 id\x3d\\\x22autoLogin\\\x22\x3e 自動ログイン\x3c\\\/label\x3e\\n      \x3c\\\/div\x3e\\n      \x3cbutton type\x3d\\\x22submit\\\x22 id\x3d\\\x22loginButton\\\x22\x3eログイン\x3c\\\/button\x3e\\n    \x3c\\\/form\x3e\\n    \x3cdiv class\x3d\\\x22register-link\\\x22\x3e\\n      新規登録は \x3ca href\x3d\\\x22#\\\x22 id\x3d\\\x22signupLink\\\x22\x3eこちら\x3c\\\/a\x3e\\n    \x3c\\\/div\x3e\\n  \x3c\\\/div\x3e\\n  \x3cscript\x3e\\n    \\n    document.getElementById(\x27loginForm\x27).addEventListener(\x27submit\x27, async function(e) \x7b\\n      e.preventDefault();\\n      const id \x3d document.getElementById(\x27loginId\x27).value.trim();\\n      const pw \x3d document.getElementById(\x27password\x27).value.trim();\\n      if (!id || !pw) \x7b\\n        showError(\x27IDとパスワードを入力してください\x27);\\n        return;\\n      \x7d\\n      \\n      document.getElementById(\x27loginButton\x27).disabled \x3d true; \\n      \\n      \\n      console.log(\x27入力値:\x27, \x7b id: id, pw: pw \x7d);\\n      \\n      try \x7b\\n        \\n        google.script.run\\n          .withSuccessHandler(function(result) \x7b\\n            try \x7b\\n              document.getElementById(\x27loginButton\x27).disabled \x3d false;\\n              \\n              \\n              console.log(\x27ログイン結果:\x27, result);\\n              console.log(\x27結果の型:\x27, typeof result);\\n              \\n              \\n              if (typeof result !\x3d\x3d \x27object\x27) \x7b\\n                console.warn(\x27結果がオブジェクトではありません:\x27, result);\\n                result \x3d \x7b success: false, error: \x27サーバーからの不正な応答\x27 \x7d;\\n              \x7d\\n              \\n              console.log(\x27処理後の結果:\x27, JSON.stringify(result));\\n              \\n              \\n              if (result \x26\x26 String(result.success) \x3d\x3d\x3d \x27true\x27) \x7b\\n                \\n                console.log(\x27ログイン成功判定\x27);\\n                alert(\x27ログイン成功！セッションID: \x27 + result.sessionId);\\n                \\n              \x7d else \x7b\\n                console.log(\x27ログイン失敗判定\x27);\\n                showError((result \x26\x26 result.error) || \x27ログインに失敗しました\x27);\\n              \x7d\\n            \x7d catch (innerErr) \x7b\\n              console.error(\x27結果処理エラー:\x27, innerErr);\\n              showError(\x27結果処理中にエラーが発生しました: \x27 + innerErr.message);\\n            \x7d\\n          \x7d)\\n          .withFailureHandler(function(error) \x7b\\n            document.getElementById(\x27loginButton\x27).disabled \x3d false;\\n            console.error(\x27通信エラー:\x27, error);\\n            showError(\x27通信エラーが発生しました: \x27 + (error ? error.message : \x27不明なエラー\x27));\\n          \x7d)\\n          .processLogin(id, pw);\\n      \x7d catch (outerErr) \x7b\\n        document.getElementById(\x27loginButton\x27).disabled \x3d false;\\n        console.error(\x27全体エラー:\x27, outerErr);\\n        showError(\x27システムエラーが発生しました: \x27 + outerErr.message);\\n      \x7d \\n    \x7d);\\n\\n    function showError(msg) \x7b\\n      const errorDiv \x3d document.getElementById(\x27error\x27);\\n      errorDiv.textContent \x3d msg;\\n      errorDiv.classList.remove(\x27hidden\x27);\\n    \x7d\\n    \\n    \\n    document.getElementById(\x27signupLink\x27).addEventListener(\x27click\x27, function(e) \x7b\\n      e.preventDefault();\\n      \\n      try \x7b\\n        google.script.run\\n          .withSuccessHandler(function(html) \x7b\\n            \\n            document.open();\\n            document.write(html);\\n            document.close();\\n          \x7d)\\n          .withFailureHandler(function(error) \x7b\\n            console.error(\x27画面遷移エラー:\x27, error);\\n            alert(\x27画面遷移中にエラーが発生しました\x27);\\n          \x7d)\\n          .getSignupPage();\\n      \x7d catch (err) \x7b\\n        console.error(\x27エラー:\x27, err);\\n        alert(\x27エラーが発生しました: \x27 + err.message);\\n      \x7d\\n    \x7d);\\n  \x3c\\\/script\x3e\\n\x3c\\\/body\x3e\\n\x3c\\\/html\x3e\\n\x22,\x22ncc\x22:\x22\x7b\\\x22awhs\\\x22:true\x7d\x22\x7d", "", undefined, true , false  , "false", "https:\/\/n-oesxaovipkrlw2uvlcbs2ggnkojkaxm2i4u55ji-0lu-script.googleusercontent.com", "\/\/drive.google.com\/abuse?id\x3dAKkXjozpOUfnmPDTHofqDiZFp2Fy5nI0INowherxp0mxNk1_JXs78G6NRdUnLND0Toru5zb2_kIjZ8FzwSSN_E6Ci6BXnKWhD60osd8z%3A0\x26docurl\x3dhttps%3A%2F%2Fscript.google.com%2Fmacros%2Fs%2FAKfycbztjtQWr4xlgESVzPWTVmIhIjdC6FWtmRBZfobWeuu0dU3RnyRzqzO2R1TylWvrxHA7ww%2Fexec%3Fpage%3Dlogin");}
el.src = 'https:\/\/n-oesxaovipkrlw2uvlcbs2ggnkojkaxm2i4u55ji-0lu-script.googleusercontent.com\/userCodeAppPanel';
}());
</script>
</body>
</html>
